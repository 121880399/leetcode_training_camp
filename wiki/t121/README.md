# [121. 买卖股票的最佳时机](https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/)

给定一个数组，它的第 i 个元素是一支给定股票第 i 天的价格。

如果你最多只允许完成一笔交易（即买入和卖出一支股票一次），设计一个算法来计算你所能获取的最大利润。

注意：你不能在买入股票前卖出股票。

**示例 1:**

```
输入: [7,1,5,3,6,4]
输出: 5
解释: 在第 2 天（股票价格 = 1）的时候买入，在第 5 天（股票价格 = 6）的时候卖出，最大利润 = 6-1 = 5 。
     注意利润不能是 7-1 = 6, 因为卖出价格需要大于买入价格；同时，你不能在买入前卖出股票。
```

**示例 2:**

```
输入: [7,6,4,3,1]
输出: 0
解释: 在这种情况下, 没有交易完成, 所以最大利润为 0。
```

#### 1.解题思路

这一题要求最大利润，最大两个字划重点，因为他告诉我们很可能要使用到max方法。题目要求一买一卖获取最大利润。

![](https://github.com/121880399/leetcode_training_camp/blob/master/wiki/t121/1.png)

按照给定示例1，最大利润为5.那么我们很自然会想到，第i天的最大利润，应该是在第i天之前花费最小购买股票，并且在第i天卖出所得的利润。这里面最关键的就是花费最小，按照示例1，如果第一天购买股票那么就花费-7元，第二天购买就花费-1元，很显然第二天花费的最小。接下来就是用第i天的价格**减去最小花费**就得到了当天的最大收益。

#### 2.定义

dp[i]:第i天卖掉股票的最大收益

#### 3.方程

dp[i]=prices[i]-costMin

#### 4.初始值

在本题中我们没有必要用数组来存储每天的最大收益，我们只需要用一个变量来记录当前最大收益，再用一个变量记录当前最小的花费。

初始化时，当前最大收益profitMax=0。最小花费costMin=Integer.MIN_VALUE。

这里让最小花费是一个int型的负值，目的在于只要是在int范围内，给定的任何数字都会比它大，如果限定在负数范围内，意思就是给定的任意负数都大于它，也就是比它花费小，这里有点绕，可以结合代码一看就明白了。

#### 5.代码实现

```java
public int maxProfit(int[] prices) {
    //利益最大
    int profitMax = 0;
    //花费最小
    int costMin = Integer.MIN_VALUE;
    int n = prices.length;
    for(int i = 0 ; i<n;i++){
        profitMax = Math.max(profitMax,costMin+prices[i]);
        costMin = Math.max(costMin,-prices[i]);
    }
    return profitMax;
}
```

costMin会一直是一个负数，在负数范围内它越大说明花费越少。profitMax就是到第i天为止的最大收益记录下来。Math.max(profitMax,costMin+prices[i])意思就是当天的最大收益和之前的最大收益的最大值。
